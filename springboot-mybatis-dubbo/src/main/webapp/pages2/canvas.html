<!DOCTYPE html>
<!-- saved from url=(0061)http://wafvj.cn/index.php?s=/home/image/img_share/id/643.html -->
<html lang="zh-cmn-Hans"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>自在打赏</title>
    <style>
    .main-box {margin: 20px 15px 30px;}
    .tips_btn {
        position: relative;
        display: block;
        margin-left: auto;
        margin-right: auto;
        padding-left: 14px;
        padding-right: 14px;
        border: 1px solid #1aad19;
        box-sizing: border-box;
        font-size: 18px;
        text-align: center;
        text-decoration: none;
        color: #1aad19;
        line-height: 2.55555556;
        border-radius: 5px;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        overflow: hidden;
        margin-bottom: 10px;
    }
}
    </style>
</head>
<body ontouchstart="">
    
<div id="main-box" class="main-box">
    <a href="javascript:;" class="tips_btn">打赏图已生成，长按图片保存</a>
    <img src="share_1501648209.jpg" style="width: 100%;height: auto;display: block;border: 1px solid #e5e5e5;">
	<canvas id="canvas" style="width: 100%;height: auto;display: block;border: 1px solid #e5e5e5;" margin="0,20"></canvas>
</div>


<script>
var data=['微信图片_20170803123857.jpg','湖南商学院渠道二维码2.png'],base64=[];
var canvas = document.getElementById("canvas");
var dataURL = canvas.toDataURL();
console.log(dataURL);
//生成画布
draw();

function draw(fn){
	var c=document.getElementById("canvas"),
	ctx=c.getContext('2d'),
	len=data.length;
	c.width=400;
	c.height=900;
	ctx.rect(0,0,c.width,c.height);
	ctx.fillStyle='rgba(225,225,225,0.5)';
	ctx.fill();
	function drawing(n){
		if(n<len){
			var img=new Image;
			//img.crossOrigin = 'Anonymous'; //解决跨域
			img.src=data[n];
			img.margin = "0,20";
			img.hspace="30";
			img.vspace="30";
			img.border="10px solid #e5e5e5";
			console.log(img);
			img.onload=function(){
				if(n==1){
					ctx.drawImage(img,10,10,60,60);
					ctx.fillStyle = '#708090';
					// 设置文字属性
					ctx.font = 'italic 14px sans-serif';
					ctx.textBaseline = 'top';
					// 填充字符串
					ctx.fillText('长按图片识别二维码，查看高清原图',80,20);
				}
				else{
					ctx.drawImage(img,10,80,c.width,c.height);
				}

				drawing(n+1);//递归
			}
		}else{
			//保存生成作品图片
			base64.push(c.toDataURL());
			alert(JSON.stringify(base64));
			fn();
		}
	}
	drawing(0);
}
</script>
</body>
</html>
